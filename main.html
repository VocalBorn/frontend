<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èªè²èšä¾†</title>
    <link id="fa-link" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"></script>
    <script>
    document.getElementById('fa-link').addEventListener('error', function() {
        this.href = 'font-awesome.min.css';
    });
    </script>
    <link rel="stylesheet" href="style_sidebar.css">
    <link rel="stylesheet" href="style_home.css">
    <link rel="stylesheet" href="style_pritice.css">
    <link rel="stylesheet" href="style_location.css">
    <link rel="stylesheet" href="style_dailyterms.css">
    <link rel="stylesheet" href="style_setting.css">
    <link rel="stylesheet" href="style_chat.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js" onerror="
    var script = document.createElement('script');
    script.src = 'chart.min.js';
    document.head.appendChild(script);
    "></script>
</head>
<body>
    <div class="loading-overlay">
        <div class="spinner"></div>
    </div>

    <section id="main" class="page">
        <div class="hamburger">
            <i class="fas fa-bars"></i>
        </div>

        <nav class="sidebar">
            <div class="logo">
                <img src="images/LOGO.png" alt="èªè²èšä¾†" style="width: 75%; height: auto; display: block; margin: 0 auto;">
            </div>
            <a href="#" class="nav-link" data-target="home">
                <i class="fas fa-home"></i>é¦–é 
            </a>
            <a href="#" class="nav-link" data-target="progress">
                <i class="fas fa-chart-line"></i>é€²åº¦è¿½è¹¤
            </a>
            <a href="#" class="nav-link" data-target="practice">
                <i class="fas fa-gamepad"></i>æƒ…å¢ƒç·´ç¿’
            </a>
            <a href="#" class="nav-link" data-target="location-terms">
                <i class="fa-solid fa-location-dot"></i> æ™ºæ…§å®šä½
            </a>
            <a href="#" class="nav-link" data-target="daily-terms">
                <i class="fas fa-comments"></i>å¸¸ç”¨ç”¨èª
            </a>
            <a href="#" class="nav-link" data-target="instant-messaging-terms">
                <i class="fas fa-user-alt"></i>å³æ™‚æºé€š
            </a>  
            <a href="#" class="nav-link" data-target="settings">
                <i class="fas fa-cog"></i>è¨­å®š
            </a>
        </nav>

        <div class="overlay"></div>

        <div class="main-content">
            <div id="home-content" class="main-content-page active">
                <section class="hero-section">
                    <div class="hero-content">
                        <h1>æ­¡è¿å›ä¾†ï¼ŒXXXï¼</h1>
                        <p>ä»Šå¤©æ˜¯æ‚¨èªè¨€æ²»ç™‚çš„ç¬¬ 15 å¤©ï¼Œè®“æˆ‘å€‘ç¹¼çºŒåŠªåŠ›å§ï¼</p>
                    </div>
                </section>
                <section class="task-section">
                    <div class="task-title">
                        <i class="fa-solid fa-bolt"></i>
                        ä»Šæ—¥ä»»å‹™
                    </div>
                    <div class="task-cards">
                        <!-- ä»Šæ—¥å­¸ç¿’å¡ç‰‡ -->
                        
                        <div class="task-card">
                            <h4>ğŸ“… æ¯æ—¥ç°½åˆ°</h4>
                            <p>å®Œæˆä»Šæ—¥ç°½åˆ°ï¼Œä¿æŒå­¸ç¿’ç¿’æ…£</p>
                            <button class="task-btn" onclick="signInToday()">ç«‹å³ç°½åˆ°</button>
                        </div>

                        <!-- å®šä½æŒ‘æˆ°å¡ç‰‡ -->
                        <div class="task-card">
                            <h4>ğŸ“˜ æƒ…å¢ƒç·´ç¿’</h4>
                            <p>å®Œæˆ 1 æ¬¡é†«é™¢æƒ…å¢ƒç·´ç¿’</p>
                            <button class="task-btn" onclick="switchPage('practice')">å‰å¾€</button>
                            <div class="progress-wrapper">
                            <div class="progress-label">ä»Šæ—¥å­¸ç¿’é€²åº¦</div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 60%;"></div>
                            </div>
                            </div>
                        </div>
                        <!-- æ–°å¢åŠŸèƒ½å¡: æƒæ QR Code -->
                        <div class="practice-card" style="cursor: pointer;">
                        <div class="practice-title">æƒæ QR Code</div>
                        <div class="practice-description">å¿«é€Ÿæƒæä¸¦åŠ å…¥èªè¨€æ²»ç™‚æ’ç¨‹</div>
                        </div>

                        <!-- æ–°å¢åŠŸèƒ½å¡: é ç´„èªè¨€æ²»ç™‚ -->
                        <div class="practice-card" style="cursor: pointer;">
                        <div class="practice-title">é ç´„èªè¨€æ²»ç™‚</div>
                        <div class="practice-description">ç«‹å³é ç´„å°ˆå±¬èªè¨€æ²»ç™‚æ™‚æ®µ</div>
                        </div>
                    </div>
                </section>
                <section class="motivation-quote">
                    <i class="fas fa-quote-left quote-icon"></i>
                    <div class="quote-text">
                        ã€ŒæŒä¹‹ä»¥æ†çš„ç·´ç¿’æ˜¯é€²æ­¥çš„é—œéµï¼Œè®“æˆ‘å€‘ä¸€èµ·åŠªåŠ›ï¼ã€
                    </div>
                    <div class="quote-author">- æ‚¨çš„èªè¨€æ²»ç™‚å¸«</div>
                </section>
            </div>

            <div id="progress-content" class="main-content-page">
                <section class="hero-section">
                    <div class="hero-content">
                        <h1>é€²åº¦è¿½è¹¤</h1>
                        <p>æŸ¥çœ‹æ‚¨çš„å­¸ç¿’é€²åº¦å’Œæˆå°±</p>
                    </div>
                </section>

                <div class="quick-stats">
                    <div class="stat-card">
                        <div class="stat-number">12</div>
                        <div class="stat-label">å·²å®Œæˆç·´ç¿’</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">85%</div>
                        <div class="stat-label">å¹³å‡æº–ç¢ºç‡</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">3</div>
                        <div class="stat-label">ä»Šæ—¥å¾…å®Œæˆ</div>
                    </div>
                </div>

                <section class="progress-section">
                    <div class="card-header">
                        <i class="fas fa-chart-line"></i>
                        <h3>å­¸ç¿’é€²åº¦</h3>
                    </div>
                    <div class="progress-chart">
                        <canvas id="progressChart"></canvas>
                    </div>
                </section>

                <section class="achievement-section">
                    <div class="card-header">
                        <i class="fas fa-trophy"></i>
                        <h3>æˆå°±</h3>
                    </div>
                    <div class="achievement-grid">
                        <div class="achievement-card">
                            <div class="achievement-icon">
                                <i class="fas fa-medal"></i>
                            </div>
                            <div class="achievement-title">å®Œæˆ 10 æ¬¡ç·´ç¿’</div>
                            <div class="achievement-description">æ­å–œæ‚¨å®Œæˆäº† 10 æ¬¡ç·´ç¿’ï¼Œç¹¼çºŒåŠ æ²¹ï¼</div>
                        </div>
                        <div class="achievement-card">
                            <div class="achievement-icon">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="achievement-title">é”åˆ° 90% æº–ç¢ºç‡</div>
                            <div class="achievement-description">æ‚¨çš„å¹³å‡æº–ç¢ºç‡é”åˆ°äº† 90%ï¼Œä¿æŒé€™å€‹å¥½æˆç¸¾ï¼</div>
                        </div>
                    </div>
                </section>
            </div>

            <div id="practice-content" class="main-content-page">
                <section class="hero-section">
                    <div class="hero-content">
                        <h1>æƒ…å¢ƒç·´ç¿’</h1>
                        <p>é¸æ“‡ä¸€å€‹æƒ…å¢ƒé–‹å§‹ç·´ç¿’</p>
                    </div>
                </section>
            
                <div class="practice-container" id="practice-card-container"> 
                    <!-- <div class="practice-card">
                        <div class="practice-title">é¤å»³é»é¤</div>
                        <div class="practice-description">å­¸ç¿’å¦‚ä½•åœ¨é¤å»³é»é¤</div>
                        <button class="practice-button" data-video="order.mp4">é–‹å§‹ç·´ç¿’</button>
                    </div>
                    <div class="practice-card">
                        <div class="practice-title">é†«é™¢å°±è¨º</div>
                        <div class="practice-description">å­¸ç¿’å¦‚ä½•åœ¨é†«é™¢å°±è¨º</div>
                        <button class="practice-button" data-video="hospital.mp4">é–‹å§‹ç·´ç¿’</button>
                    </div>
                    <div class="practice-card">
                        <div class="practice-title">è³¼ç‰©ä»˜æ¬¾</div>
                        <div class="practice-description">å­¸ç¿’å¦‚ä½•åœ¨å•†åº—ä»˜æ¬¾</div>
                        <button class="practice-button" data-video="shopping.mp4">é–‹å§‹ç·´ç¿’</button>
                    </div>
                    <div class="practice-card">
                        <div class="practice-title">éŠ€è¡Œ</div>
                        <div class="practice-description">å­¸ç¿’å¦‚ä½•é–‹æˆ¶ã€å­˜éŒ¢ã€ææ¬¾ã€æ›åŒ¯</div>
                        <button class="practice-button" data-video="order.mp4">é–‹å§‹ç·´ç¿’</button>
                    </div>
                    <div class="practice-card">
                        <div class="practice-title">éƒµå±€</div>
                        <div class="practice-description">å­¸ç¿’å¦‚ä½•å¯„é€éƒµä»¶æˆ–åŒ…è£¹</div>
                        <button class="practice-button" data-video="order.mp4">é–‹å§‹ç·´ç¿’</button>
                    </div>
                    <div class="practice-card">
                        <div class="practice-title">æ—…éŠ</div>
                        <div class="practice-description">å­¸ç¿’å¦‚ä½•è¨‚æˆ¿èˆ‡å•æ™¯é»</div>
                        <button class="practice-button" data-video="order.mp4">é–‹å§‹ç·´ç¿’</button>
                    </div>
                    <div class="practice-card">
                        <div class="practice-title">ç·Šæ€¥ç‹€æ³</div>
                        <div class="practice-description">å­¸ç¿’åœ¨ç·Šæ€¥æ™‚å¦‚ä½•æ±‚åŠ©å’Œæ‡‰å°</div>
                        <button class="practice-button" data-video="order.mp4">é–‹å§‹ç·´ç¿’</button>
                    </div>
                    <div class="practice-card">
                        <div class="practice-title">æ—¥å¸¸ç”¨èª</div>
                        <div class="practice-description">å¸¸è¦‹æ—¥å¸¸ç”¨èª</div>
                        <button class="practice-button" data-video="order.mp4">é–‹å§‹ç·´ç¿’</button>
                    </div> -->
                </div>

                <div id="practice-video-section" class="practice-hidden">
                    <button id="practice-back-button">â† è¿”å›é¸å–®</button>
                    <div id="practice-detail-content"></div> <!--âœ… å°ˆé–€å¡æƒ…å¢ƒç´°ç¯€-->
                    <!-- <video id="practice-scenario-video" controls>
                        <source id="practice-video-source" src="" type="video/mp4">
                        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ’­æ”¾ã€‚
                    </video> -->
                </div>
            </div>

            <div id="location-terms-content" class="main-content-page">
                <section class="hero-section">
                    <div class="hero-content">
                        <h1>æ™ºæ…§å®šä½ç”¨èª</h1>
                        <p>æ ¹æ“šæ‚¨çš„ä½ç½®æ¨è–¦é©åˆçš„å¸¸ç”¨èªå¥</p>
                    </div>
                </section>
        
                <div class="location-terms-container">
                    <div class="location-info">
                        <p><i class="fa-solid fa-map-marker-alt"></i> ç›®å‰ä½ç½®ï¼š
                        <span id="currentLocation">ç²å–ä¸­...</span></p>
                    </div>
            
                    <div id="map" class="map"></div>
                
            
                    <div id="recommendedTermsList" class="terms-list">
                        <p><i class="fa-solid fa-map-location-dot"></i> é™„è¿‘åœ°é»</p>
                    </div>
            
                    <div id="suggestedPhrases" class="phrases-list hidden">
                        <p><i class="fa-solid fa-lightbulb"></i> æ¨è–¦èªå¥</p>
                        <div id="phraseButtons"></div>
                        <button id="backButton" class="back-btn"> è¿”å›åœ°é»</button>
                    </div> 
                </div>
            </div>

            <div id="daily-terms-content" class="main-content-page">
                <section class="hero-section">
                    <div class="hero-content">
                        <h1>å¸¸ç”¨ç”¨èª</h1>
                        <p>ç®¡ç†å’Œä½¿ç”¨æ‚¨çš„å¸¸ç”¨èªå¥</p>
                    </div>
                </section>
        
                <div class="daily-terms-container">
                    <div class="input-group">
                        <input type="text" id="dailyTermInput" placeholder="è¼¸å…¥å¸¸ç”¨èªå¥">
                    </div>
        
                    <div class="button-group">
                        <button id="playDailyTermButton" class="button">æ’­æ”¾</button>
                        <button id="addDailyTermButton" class="button">æ–°å¢</button>
                    </div>
        
                    <div id="dailyTermsList" class="terms-list">
                        <p><i class="fa-solid fa-heart" style="color: rgb(255, 128, 128); font-size: 24px;"></i> æ‚¨çš„æœ€æ„›</p>
                    </div>
                </div>
            </div>
            <!-- å³æ™‚æºé€šé é¢ -->
            <div id="instant-messaging-terms-content" class="main-content-page">
                <section class="hero-section">
                    <div class="hero-content">
                        <h1>å³æ™‚æºé€š</h1>
                        <p>èˆ‡æ‚¨çš„ä¸»æ²»é†«ç”Ÿå³æ™‚æºé€š</p>
                    </div>
                </section>
                <div class="chat-container">
                    <div id="chatMessages" class="chat-messages"></div>
                    <div class="chat-input-container">
                        <input type="text" id="chatInput" placeholder="è¼¸å…¥è¨Šæ¯...">
                        <button id="sendButton" class="chat-send-button">
                            <i class="fa-solid fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div id="settings-page" class="main-content-page">
                <div class="setting">
                  <img src="images/User.jpeg" alt="ä½¿ç”¨è€…ç…§ç‰‡" class="user-pic" />
                  <div class="username">é€™è£¡æ˜¯ä½¿ç”¨è€…çš„åå­—</div>
            
                  <div class="settings-container">
                    <div class="settings-item" id="showProfile">
                      <label class="auth-switch">å€‹äººæª”æ¡ˆ</label>
                      <i class="fas fa-chevron-right"></i>
                    </div>
                    <hr />
                    <div class="settings-item" id="showNotification">
                      <label>é€šçŸ¥è¨­å®š</label><i class="fas fa-chevron-right"></i>
                    </div>
                    <hr />
                    <div class="settings-item" id="showHelp">
                      <label>å¹«åŠ©</label><i class="fas fa-chevron-right"></i>
                    </div>
                    <hr />
                    <div class="settings-item" id="showAbout">
                      <label>é—œæ–¼èªè²ä¿±ä¾†</label><i class="fas fa-chevron-right"></i>
                    </div>
                    <hr />
                  </div>
            
                  <button class="logout-btn" onclick="logout()">ç™»å‡º</button>
                </div>
            </div>

            <!-- å€‹äººæª”æ¡ˆé é¢ -->
            <div id="profile-content" class="main-content-page">
            <div class="profile">
                <div class="profile-container">
                    <div class="profile-item" id="showSetting">
                        <label class="auth-switch"><i class="fas fa-chevron-left"></i>è¿”å›</label>
                    </div>
                    <hr/>
                    <div class="profile-item">
                        <label class="profile-option" id="edit-name" data-target="edit-name">å§“å</label>
                    </div>
                    <hr/>
                    <div class="profile-item">
                        <label class="profile-option" id="editGender" data-target="edit-gender">æ€§åˆ¥</label>
                    </div>
                    <hr/>
                    <div class="profile-item">
                        <label id="changePassword" class="profile-option" data-target="change-password">è®Šæ›´å¯†ç¢¼</label>
                    </div>
                </div>
            </div>
        </div>

            <!-- å§“åç·¨è¼¯é é¢ -->
            <div id="edit-name-content" class="main-content-page hidden">
                <div class="card">
                    <div class="card-header">
                        <div class="edit-name-item" id="backToProfile">
                            <label class="auth-switch"><i class="fas fa-chevron-left"></i> è¿”å›</label>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label>ç·¨è¼¯å§“å</label>
                            <input type="text" id="nameInput" placeholder="è¼¸å…¥æ–°å§“å">
                        </div>
                        <hr />
                        <div class="form-group">
                            <button class="button" onclick="saveName()">å„²å­˜</button>
                        </div>
                        <hr />
                    </div>
                </div>
            </div>
            <div id="edit-gender-content" class="main-content-page hidden">
                <div class="card">
                    <div class="card-header">
                    <div class="edit-gender-item" id="backToProfileFromGender">
                        <label class="auth-switch"><i class="fas fa-chevron-left"></i> è¿”å›</label>
                    </div>
                    </div>
                    <div class="card-content">
                    <div class="form-group">
                        <label for="genderSelect">é¸æ“‡æ€§åˆ¥</label>
                        <select id="genderSelect">
                        <option value="male">ç”·</option>
                        <option value="female">å¥³</option>
                        <option value="other">å…¶ä»–</option>
                        </select>
                    </div>
                    <hr />
                    <div class="form-group">
                        <button class="button" onclick="saveGender()">å„²å­˜</button>
                    </div>
                    </div>
                </div>
            </div>
            <div id="change-password-content" class="main-content-page">
                <div class="card">
                    <div class="card-header">
                    <div class="edit-name-item" id="backToProfileFromPassword">
                        <label class="auth-switch"><i class="fas fa-chevron-left"></i> è¿”å›</label>
                    </div>
                    </div>
                    <div class="card-content">
                    <div class="form-group">
                        <label for="currentPassword">ç›®å‰å¯†ç¢¼</label>
                        <input type="password" id="currentPassword" placeholder="è«‹è¼¸å…¥ç›®å‰å¯†ç¢¼" />
                    </div>
                    <hr />
                    <div class="form-group">
                        <label for="newPassword">æ–°å¯†ç¢¼</label>
                        <input type="password" id="newPassword" placeholder="è«‹è¼¸å…¥æ–°å¯†ç¢¼" />
                    </div>
                    <hr />
                    <div class="form-group">
                        <label for="confirmPassword">ç¢ºèªæ–°å¯†ç¢¼</label>
                        <input type="password" id="confirmPassword" placeholder="å†æ¬¡è¼¸å…¥æ–°å¯†ç¢¼" />
                    </div>
                    <hr />
                    <div class="form-group">
                        <button class="button" onclick="submitPasswordChange()">å„²å­˜è®Šæ›´</button>
                    </div>
                    </div>
                </div>
                </div>

            
            
            <div id="notification-content" class="main-content-page">
                <div class="notification">
                    <div class="notification-container">
                        <div class="notification-item" id="backToSettingfromNotify">
                            <label class="auth-switch"><i class="fas fa-chevron-left"></i>è¿”å›</label>
                        </div>
                        <hr/>
                        <div class="notification-item">
                            <label>æ¯æ—¥ç·´ç¿’æé†’</label>
                            <div class="setting-toggle">
                                <label class="switch">
                                  <input type="checkbox" id="notifyToggle" checked>
                                  <span class="slider round"></span>
                                </label>
                              </div>
                              
                        </div>
                    </div>
                </div>
            </div>
        

            <div id="help-content" class="main-content-page">
                <div class="help">
                    <div class="help-container">
                        <div class="help-item" id="backToSettingfromHelp">
                            <label class="auth-switch"><i class="fas fa-chevron-left"></i>è¿”å›</label>
                        </div>
                        <hr/>
                        <div class="help-item" id="how-to-change-password-item">
                            <label>å¦‚ä½•æ›´æ”¹å¯†ç¢¼ï¼Ÿ</label>
                        </div>
                        <hr/>
                        <div class="help-item" id="tutorial-item">
                            <label>ä½¿ç”¨æ•™å­¸</label>
                        </div>
                    </div>
                </div>
            </div>
            <div id="how-to-change-password-content" class="main-content-page hidden">
                <div class="card">
                    <div class="card-header">
                    <label class="auth-switch" id="backToHelpFromHowTo"><i class="fas fa-chevron-left"></i> è¿”å›</label>
                    </div>
                    <div class="card-content">
                    <h2>å¦‚ä½•æ›´æ”¹å¯†ç¢¼</h2>
                    <ol class="instruction-list">
                        <li>åœ¨ä¸»ç•«é¢é»é¸å³å´é¸å–®ã€Œè¨­å®šã€ã€‚</li>
                        <li>é»é¸ã€Œå€‹äººæª”æ¡ˆã€ã€‚</li>
                        <li>åœ¨é¸å–®ä¸­é»é¸ã€Œè®Šæ›´å¯†ç¢¼ã€ã€‚</li>
                        <li>è¼¸å…¥ç›®å‰å¯†ç¢¼ã€æ–°å¯†ç¢¼èˆ‡ç¢ºèªå¯†ç¢¼ï¼Œç„¶å¾ŒæŒ‰ä¸‹ã€Œå„²å­˜ã€ã€‚</li>
                        <li>å¯†ç¢¼è®Šæ›´æˆåŠŸå¾Œï¼Œæœƒè‡ªå‹•è¿”å›å€‹äººæª”æ¡ˆé é¢ã€‚</li>
                    </ol>
                    <p class="tip">âš ï¸ æ–°å¯†ç¢¼éœ€è‡³å°‘ 6 å€‹å­—å…ƒï¼Œä¸”å…©æ¬¡è¼¸å…¥å¿…é ˆä¸€è‡´ã€‚</p>
                    </div>
                </div>
            </div>
            <div id="tutorial-content" class="main-content-page hidden">
                <div class="card">
                    <div class="card-header">
                    <label class="auth-switch" id="backToHelpFromTutorial">
                        <i class="fas fa-chevron-left"></i> è¿”å›
                    </label>
                    </div>
                    <div class="card-content">
                    <h2>ä½¿ç”¨æ•™å­¸</h2>
                    <ol class="instruction-list">
                        <li>é–‹å•Ÿç¶²ç«™å¾Œï¼Œè«‹å…ˆè¨»å†Šæˆ–ç™»å…¥å¸³è™Ÿã€‚</li>
                        <li>ç™»å…¥æˆåŠŸå¾Œï¼Œé€²å…¥ä¸»ç•«é¢ï¼Œé¸æ“‡ã€Œæ¯æ—¥è©å½™ã€å¯æ–°å¢èªå¥ä¸¦æ’­æ”¾ç™¼éŸ³ã€‚</li>
                        <li>ä½¿ç”¨ã€Œç·´ç¿’æ¨¡å¼ã€è§€çœ‹å½±ç‰‡ä¸¦è·Ÿè®€å°è©±ï¼Œæå‡å£èªèƒ½åŠ›ã€‚</li>
                        <li>é€²å…¥ã€Œæ™ºæ…§å®šä½ã€ï¼Œç³»çµ±æœƒæ¨è–¦é™„è¿‘å ´æ‰€å°æ‡‰çš„èªå¥ã€‚</li>
                        <li>é€éå³ä¸Šè§’çš„å€‹äººé¸å–®å¯é€²è¡Œã€Œå§“åç·¨è¼¯ã€ã€ã€Œè®Šæ›´å¯†ç¢¼ã€ã€ã€Œæ€§åˆ¥è¨­å®šã€ç­‰å€‹äººåŒ–è¨­å®šã€‚</li>
                        <li>é»é¸ã€Œé€²åº¦ã€é é¢å¯æŸ¥çœ‹å­¸ç¿’æ›²ç·šã€‚</li>
                    </ol>
                    <div class="tip">
                        å°æé†’ï¼šè«‹é–‹å•Ÿç€è¦½å™¨çš„éº¥å…‹é¢¨èˆ‡å®šä½æ¬Šé™ï¼Œä»¥ç²å¾—æœ€ä½³é«”é©—ï¼
                    </div>
                    </div>
                </div>
            </div>

            <div id="about-content" class="main-content-page">
                <div class="about">
                    <div class="about-container">
                        <div class="about-item" id="backToSettingfromAbout">
                            <label class="auth-switch"><i class="fas fa-chevron-left"></i>è¿”å›</label>
                        </div>
                        <hr/>
                        <div class="about-item">
                            <a href="private.html">ä½¿ç”¨æ¢æ¬¾èˆ‡éš±ç§æ¬Šæ”¿ç­–</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async() => {
            // const backButton = document.getElementById('practice-back-button');
            //         if (backButton) {
            //             backButton.addEventListener('click', () => {
            //                 document.getElementById('practice-video-section').style.display = 'none';
            //                 document.getElementById('practice-content').style.display = 'block';
            //             });
            //         }
            const token = localStorage.getItem("token");

            if (!token) {
                alert("å°šæœªç™»å…¥ï¼Œè«‹é‡æ–°ç™»å…¥");
                window.location.href = "index.html";
                return;
            }

            // ç”¨ token å‘¼å«éœ€è¦æˆæ¬Šçš„ API
            fetch("https://api-vocalborn.r0930514.work/user/profile", {
                method: "PATCH",
                headers: {
                    "Authorization": "Bearer " + token
                }
            })
            .then(res => res.json())
            .then(data => {
                console.log("ä½¿ç”¨è€…è³‡æ–™ï¼š", data);
                // åœ¨ç•«é¢ä¸Šé¡¯ç¤ºè³‡æ–™
            })
            .catch(err => {
                console.error("å–å¾—è³‡æ–™å¤±æ•—", err);
                alert("é©—è­‰å¤±æ•—ï¼Œè«‹é‡æ–°ç™»å…¥");
                window.location.href = "index.html";
            });

            //è®Šæ›´å¯†ç¢¼
            window.submitPasswordChange = async function () {
                const currentPassword = document.getElementById('currentPassword').value.trim();
                const newPassword = document.getElementById('newPassword').value.trim();
                const confirmPassword = document.getElementById('confirmPassword').value.trim();

                // ç°¡å–®é©—è­‰
                if (!currentPassword || !newPassword || !confirmPassword) {
                    alert('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½');
                    return;
                }

                if (newPassword !== confirmPassword) {
                    alert('æ–°å¯†ç¢¼èˆ‡ç¢ºèªå¯†ç¢¼ä¸ä¸€è‡´');
                    return;
                }

                const token = localStorage.getItem('token');
                if (!token) {
                    alert("è«‹å…ˆç™»å…¥");
                    window.location.href = 'index.html';
                    return;
                }

                try {
                    console.log("é€å‡ºçš„ tokenï¼š", token);
                    const response = await fetch('https://api-vocalborn.r0930514.work/user/password', {
                        method: 'PATCH',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer ' + token
                        },
                        body: JSON.stringify({
                            old_password: currentPassword,
                            new_password: newPassword
                        })
                    });

                    const result = await response.json();

                    if (response.ok) {
                        alert('å¯†ç¢¼è®Šæ›´æˆåŠŸ');
                        // æ¸…ç©ºè¼¸å…¥æ¬„ä½
                        document.getElementById('currentPassword').value = '';
                        document.getElementById('newPassword').value = '';
                        document.getElementById('confirmPassword').value = '';
                        window.location.href = '#settings';
                    } else {
                        alert(result.message || 'å¯†ç¢¼è®Šæ›´å¤±æ•—');
                    }

                } catch (error) {
                    console.error('Error:', error);
                    alert('ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦');
                }
            };


            //å–å¾—æƒ…å¢ƒåˆ—è¡¨
                const container = document.getElementById('practice-card-container');
                const content=document.getElementById('practice-content');
                const videoSection = document.getElementById('practice-video-section');
                // document.getElementById('practice-back-button').onclick = () => {
                //             document.getElementById('practice-video-section').style.display = 'none';
                //             document.getElementById('practice-content').style.display = 'block';
                //             };
                if (!container) {
                    console.error('æ‰¾ä¸åˆ° #practice-card-container å®¹å™¨å…ƒç´ ï¼');
                    return;
                }

                fetch('https://api-vocalborn.r0930514.work/situations/list?skip=0&limit=10', {
                    headers: {
                    'Authorization': 'Bearer '+token,
                    'Content-Type': 'application/json'
                    }
                })
                .then(res => {
                    console.log('HTTP å›å‚³ç‹€æ…‹ç¢¼ï¼š', res.status);
                    return res.json().then(data => {
                        console.log('API åŸå§‹è³‡æ–™ï¼ˆä¸è«–éŒ¯èª¤èˆ‡å¦ï¼‰ï¼š', data);

                    if (!res.ok) {
                    throw new Error(`HTTP error! status: ${res.status}`);
                    }

                    return data;
                    });
                })

                .then(data => {
                console.log('API å›å‚³è³‡æ–™ï¼š', data);

                const situations = Array.isArray(data.situations) ? data.situations : data;
                if (!Array.isArray(situations)) {
                    throw new Error('API å›å‚³æ ¼å¼éŒ¯èª¤ï¼Œä¸æ˜¯é™£åˆ—');
                }

                //container.innerHTML = '';

                situations.forEach(situation => {
                    console.log(situation);

                    const card = document.createElement('div');
                    card.className = 'practice-card';
                    card.innerHTML = `
                    <div class="practice-title">${situation.situation_name}</div>
                    <div class="practice-description">${situation.description}</div>
                    <button class="practice-button" data-id="${situation.situation_id}">é–‹å§‹ç·´ç¿’</button>
                    `;

                    //é»ã€Œé–‹å§‹ç·´ç¿’ã€å¾Œé€²å…¥è©²æƒ…å¢ƒç·´ç¿’ç•«é¢
                    const button = card.querySelector('.practice-button');
                    button.addEventListener('click', () => {
                        const situationId = button.getAttribute('data-id'); // é€™è£¡ä¿®æ­£ç‚ºå– data-id
                        const contentSection = document.getElementById('practice-content');
                        const backButton = document.getElementById('practice-back-button');

                        document.getElementById('practice-content').classList.add('practice-hidden');
                        document.getElementById('practice-video-section').classList.remove('practice-hidden');
                        container.style.display = 'none';

                        const detailContainer = document.getElementById('practice-detail-content');
                        if (detailContainer) {
                            detailContainer.innerHTML = `
                                <div class="loader"></div>
                                <p style="text-align:center;">è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...</p>
                            `;
                        }

                        fetch(`https://api-vocalborn.r0930514.work/situations/${situationId}`, {
                            headers: {
                                'Authorization': 'Bearer ' + token,
                                'Content-Type': 'application/json'
                            }
                        })
                        .then(res => {
                            if (!res.ok) {
                                throw new Error(`HTTP éŒ¯èª¤ï¼ç‹€æ…‹ç¢¼ï¼š${res.status}`);
                            }
                            return res.json();
                        })
                        .then(detailData => {
                            const detailContainer = document.getElementById('practice-detail-content');
                            if (detailContainer) {
                                detailContainer.innerHTML = `
                                    <h2>${detailData.situation_name}</h2>
                                    <p><strong>åœ°é»ï¼š</strong>${detailData.location}</p>
                                    <p><strong>æƒ…å¢ƒæè¿°ï¼š</strong>${detailData.description}</p>
                                    <video id="practice-scenario-video" controls width="640">
                                        <source id="practice-video-source" src="" type="video/mp4">
                                        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ’­æ”¾ã€‚
                                    </video>
                                    <p id="video-message" style="color: red; text-align: center;"></p>
                                `;

                                // âœ¨é€™å…©å€‹æ“ä½œç­‰è³‡æ–™æº–å‚™å¥½å¾Œå†åš
                                container.classList.add('practice-hidden');
                                videoSection.classList.remove('practice-hidden');
                            }

                            //videoSection.classList.remove('practice-hidden');
                            //videoSection.classList.add('show');

                            if (backButton) {
                                backButton.addEventListener('click', () => {
                                    videoSection.classList.add('practice-hidden'); // éš±è—å½±ç‰‡å€
                                    content.classList.remove('practice-hidden'); // é¡¯ç¤ºæƒ…å¢ƒå¡ç‰‡å€
                                    // ç¢ºä¿å¡ç‰‡å®¹å™¨é¡¯ç¤º
                                    const container = document.getElementById('practice-card-container');
                                    if (container) {
                                        container.style.display = 'grid'; // æˆ– 'grid'ï¼Œæ ¹æ“šä½ çš„ CSS è¨­è¨ˆ
                                    }
                                });
                            }
                        })
                        .catch(error => {
                            alert('è¼‰å…¥ç·´ç¿’è³‡æ–™å¤±æ•—ï¼' + error.message);
                        });
                    });
                    
                    console.log(situation);
                    container.appendChild(card);
                });
            })
                .catch(err => {
                console.error('è¼‰å…¥æƒ…å¢ƒå¤±æ•—ï¼š', err);
                container.innerHTML = '<p style="color: red;">è¼‰å…¥æƒ…å¢ƒå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚</p>';
                });

                // ğŸ”¹ è¼‰å…¥ä½¿ç”¨è€…å€‹äººè³‡æ–™ï¼ˆå§“åã€æ€§åˆ¥ï¼‰
                try {
                    const res = await fetch("https://api-vocalborn.r0930514.work/user/profile", {
                        method: "GET",
                        headers: {
                            "Authorization": "Bearer " + token
                        }
                    });

                    const data = await res.json();
                    console.log("ä½¿ç”¨è€…è³‡æ–™ï¼š", data);

                    // é¡¯ç¤ºä½¿ç”¨è€…åç¨±
                    const usernameDiv = document.querySelector('.username');
                    if (usernameDiv && data.name) {
                        usernameDiv.textContent = data.name;
                    }

                    // é¡¯ç¤ºå§“åèˆ‡æ€§åˆ¥åˆ°è¡¨å–®
                    if (data.name) {
                        const nameInput = document.getElementById("nameInput");
                        if (nameInput) nameInput.value = data.name;
                    }

                    if (data.gender) {
                        const genderSelect = document.getElementById("genderSelect");
                        if (genderSelect) {
                            const genderMap = {
                                male: "male", //å¾Œè€…(ç¶ è‰²)æ˜¯htmlçš„valueï¼ˆç¬¬364è¡Œï¼‰
                                female: "female", 
                                other: "other"
                            };
                            const mappedGender = genderMap[data.gender.toLowerCase()];
                            if (mappedGender) {
                                genderSelect.value = mappedGender;
                            } else {
                                console.warn("æœªçŸ¥çš„æ€§åˆ¥å€¼ï¼š", data.gender);
                            }
                        }
                    }

                } catch (error) {
                    console.error("è¼‰å…¥ä½¿ç”¨è€…è³‡æ–™å¤±æ•—", error);
                    alert("å–å¾—å€‹äººè³‡æ–™å¤±æ•—ï¼Œè«‹é‡æ–°ç™»å…¥");
                    window.location.href = "index.html";
                }
            
            //æ›´æ”¹å€‹äººè³‡æ–™å…§å®¹
            // è¨­å®šå„²å­˜å§“ååŠŸèƒ½
            window.saveName = async function () {
                const newName = document.getElementById("nameInput").value.trim();
                if (!newName) {
                    alert("è«‹è¼¸å…¥æ–°å§“å");
                    return;
                }

                try {
                    const res = await fetch("https://api-vocalborn.r0930514.work/user/profile", {
                        method: "PATCH",
                        headers: {
                            "Content-Type": "application/json",
                            "Authorization": "Bearer " + token
                        },
                        body: JSON.stringify({ name: newName })
                    });

                    const result = await res.json();
                    if (res.ok) {
                        alert("å§“åå·²æ›´æ–°");
                        // åŒæ­¥æ›´æ–°ç•«é¢ä¸Šçš„åç¨±
                        const usernameDiv = document.querySelector(".username");
                        if (usernameDiv) usernameDiv.textContent = newName;
                        window.location.href = '#settings';
                    } else {
                        alert(result.message || "æ›´æ–°å¤±æ•—");
                    }
                } catch (err) {
                    console.error("æ›´æ–°å§“åå¤±æ•—ï¼š", err);
                    alert("ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦");
                }
            };

            // è¨­å®šå„²å­˜æ€§åˆ¥åŠŸèƒ½
            window.saveGender = async function () {
                const newGender = document.getElementById("genderSelect").value;

                try {
                    const res = await fetch("https://api-vocalborn.r0930514.work/user/profile", {
                        method: "PATCH",
                        headers: {
                            "Content-Type": "application/json",
                            "Authorization": "Bearer " + token
                        },
                        body: JSON.stringify({ gender: newGender })
                    });

                    const result = await res.json();
                    if (res.ok) {
                        alert("æ€§åˆ¥å·²æ›´æ–°");
                        window.location.href = '#settings';
                    } else {
                        alert(result.message || "æ›´æ–°å¤±æ•—");
                    }
                } catch (err) {
                    console.error("æ›´æ–°æ€§åˆ¥å¤±æ•—ï¼š", err);
                    alert("ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦");
                }
            };

        });
    </script>
</body>
</html>